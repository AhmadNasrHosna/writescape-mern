(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{214:function(e,a){},220:function(e,a,t){"use strict";t.r(a);var c=t(0),s=t.n(c),r=t(14),l=t(3),n=t(5),m=t(13),o=t(187),i=t.n(o);a.default=function(){const{isChatOpen:e,user:a,loggedIn:t}=Object(c.useContext)(n.a),o=Object(c.useContext)(m.a),u=Object(c.useRef)(null),h=Object(c.useRef)(null),f=Object(c.useRef)(null),[d,p]=Object(r.a)({fieldValue:"",chatMessages:[]});return Object(c.useEffect)(()=>{e&&(u.current.focus(),o({type:"clearUnreadChatCount"}))},[e]),Object(c.useEffect)(()=>{t||o({type:"closeChat"})},[t]),Object(c.useEffect)(()=>{h.current.scrollTop=h.current.scrollHeight,d.chatMessages.length&&!e&&o({type:"incrementUnreadChatCount"})},[d.chatMessages]),Object(c.useEffect)(()=>(f.current=i()("http://localhost:8080"),f.current.on("chatFromServer",e=>{p(a=>{a.chatMessages.push(e)})}),()=>f.current.disconnect()),[]),s.a.createElement("div",{id:"chat-wrapper",className:"chat-wrapper shadow border-top border-left border-right "+(e?"chat-wrapper--is-visible":"")},s.a.createElement("div",{className:"chat-title-bar bg-primary"},"Chat",s.a.createElement("span",{className:"chat-title-bar-close",onClick:()=>o({type:"closeChat"})},s.a.createElement("i",{className:"fas fa-times-circle"}))),s.a.createElement("div",{id:"chat",className:"chat-log",ref:h},d.chatMessages.map(({message:e,username:t,avatar:c},r)=>t==a.username?s.a.createElement("div",{className:"chat-self",key:r},s.a.createElement("div",{className:"chat-message"},s.a.createElement("div",{className:"chat-message-inner"},e)),s.a.createElement("img",{className:"chat-avatar avatar-tiny",src:c})):s.a.createElement("div",{className:"chat-other",key:r},s.a.createElement(l.b,{to:"/profile/"+t},s.a.createElement("img",{className:"avatar-tiny",src:c})),s.a.createElement("div",{className:"chat-message"},s.a.createElement("div",{className:"chat-message-inner"},s.a.createElement(l.b,{to:"/profile/"+t},s.a.createElement("strong",null,t,": ")),e))))),s.a.createElement("form",{onSubmit:function(e){e.preventDefault(),f.current.emit("chatFromBrowser",{message:d.fieldValue,token:a.token}),p(e=>{e.chatMessages.push({message:e.fieldValue,username:a.username,avatar:a.avatar}),e.fieldValue=""})},id:"chatForm",className:"chat-form border-top"},s.a.createElement("input",{type:"text",className:"chat-field",id:"chatField",placeholder:"Type a messageâ€¦",autoComplete:"off",ref:u,value:d.fieldValue,onChange:function(e){const a=e.target.value;p(e=>{e.fieldValue=a})}})))}}}]);